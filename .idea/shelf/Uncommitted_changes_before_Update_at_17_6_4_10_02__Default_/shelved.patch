Index: js/sections.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>/**\n * Created by zackbee on 17-6-4.\n */\n(function () {\n    /* addPlayerEvents\n     * Version 1.0\n     * created by ZackBee\n     * 2017.06.03*/\n\n    /* 此代码支持IE9+以及其他浏览器，\n     * 使用了dom2级的特性，由于IE8\n     * 以及以下版本（未完全支持dom2）\n     * 未实现audio,video所以不用考虑*/\n\n    function addPlayerEvents(element) {\n        \"use strict\";\n        //传入单个元素\n        if (element.length === 1) {\n            addEvents(element);\n        } else {\n            //传入nodeList\n            for (var i = 0, len = element.length; i < len; i++) {\n                addEvents(element[i]);\n            }\n        }\n\n        function addEvents(element) {\n            //getElementsByClassName ie9+可以使用\n            var pauseBtn = element.getElementsByClassName(\"pause-btn\")[0],\n                timeLine = element.getElementsByClassName(\"time-line\")[0],\n                timeLineDuration = timeLine.children[0],\n                timeLineBtn = element.getElementsByClassName(\"time-line-btn\")[0],\n                controls = element.getElementsByClassName(\"controls\")[0],\n                timeNow = element.getElementsByClassName(\"time-text-now\")[0],\n                timeFull = element.getElementsByClassName(\"time-text-full\")[0],\n                playerPlaying = false,\n                //ie9+支持getComputedStyle\n                getComputedStyle = document.defaultView.getComputedStyle,\n                durationPercent = 0,\n                allTime = 0,\n                offsetLeft = 0,\n                currentElement = timeLineBtn.offsetParent;\n\n\n            //初始化\n            timeLineDuration.style.width = \"0\";\n            pauseBtn.style.left = \"0\";\n\n            do {\n                offsetLeft += currentElement.offsetLeft;\n                currentElement = currentElement.offsetParent;\n            } while (currentElement);\n\n\n            //增加对pauseBtn的相应事件\n            //监听对pause按钮的点击操作,ie9+支持addEventListener\n            //addEventListener ie9+可以使用\n            pauseBtn.addEventListener(\"click\", function () {\n                if (playerPlaying === true) {\n                    btnPauseHandler();\n                    controls.pause();\n                } else {\n                    btnPlayHandler();\n                    controls.play();\n                }\n            });\n\n\n            //增加对timeLineBtn的相应事件\n            //鼠标移出pauseBtn改变对mousemove事件的监听状态\n            //removeEventListener ie9+可以使用\n            timeLineBtn.addEventListener(\"mousedown\", function () {\n                window.addEventListener(\"mousemove\", mouseMoveHandler);\n                timeLineBtn.className = \"time-line-btn\" + \" \" + \"time-line-btn-focus\";\n            });\n\n            //监听click事件，解决使用触摸板操作的问题\n            window.addEventListener(\"click\", function () {\n                window.removeEventListener(\"mousemove\", mouseMoveHandler);\n            });\n\n            //改变播放器的播放时间\n            function mouseMoveHandler(event) {\n                timeLineBtn.style.left = parseInt(event.pageX - offsetLeft);\n                controls.currentTime = String(getCurrentTime(event));\n            }\n\n            function getCurrentTime(event) {\n                var width = parseInt(event.pageX - offsetLeft),\n                    allWidth = parseInt(getComputedStyle(timeLine, null).width);\n                durationPercent = width / allWidth;\n                return parseInt(durationPercent * allTime);\n            }\n\n            //增加对timeLine的事件\n            timeLine.addEventListener(\"click\", function () {\n                controls.currentTime = String(getCurrentTime(event));\n            });\n            //使得鼠标放在上面时显示时间\n            timeLine.addEventListener(\"mousemove\", function (event) {\n                var time = getCurrentTime(event);\n                timeLine.title = getFormatTime(time);\n            });\n\n\n            //增加对播放器数据更新的相应事件\n            //监听是否播放结束，并对其做相应处理\n            controls.addEventListener(\"ended\", btnPauseHandler);\n\n            controls.addEventListener(\"pause\", btnPauseHandler);\n\n            function btnPauseHandler() {\n                pauseBtn.className = \"pause-btn\" + \" \" + \"pause-btn-pause\";\n                timeLineBtn.className = \"time-line-btn\" + \" \" + \"time-line-btn-ini\";\n                playerPlaying = false;\n            }\n\n            controls.addEventListener(\"play\", btnPlayHandler);\n\n            function btnPlayHandler() {\n                pauseBtn.className = \"pause-btn\" + \" \" + \"pause-btn-play\";\n                timeLineBtn.className = \"time-line-btn\" + \" \" + \"time-line-btn-focus\";\n                playerPlaying = true;\n            }\n\n            controls.addEventListener(\"loadedmetadata\", function () {\n                allTime = controls.duration;\n                timeNow.innerHTML = getFormatTime(controls.currentTime);\n                timeFull.innerHTML = getFormatTime(controls.duration);\n            });\n\n            controls.addEventListener(\"timeupdate\", function () {\n                var percent = controls.currentTime / allTime;\n                timeLineBtn.style.left = parseInt(percent *\n                        parseInt(getComputedStyle(timeLine, null).width)) + \"px\";\n                timeLineDuration.style.width = parseInt(percent *\n                        parseInt(getComputedStyle(timeLine, null).width)) + \"px\";\n                timeNow.innerHTML = getFormatTime(controls.currentTime);\n                timeFull.innerHTML = getFormatTime(controls.duration);\n            });\n\n            //转换时间成标准格式\n            function getFormatTime(time) {\n                time = parseInt(time);\n                var hour = parseInt(time / 3600),\n                    minute = parseInt((time % 3600) / 60),\n                    second = time % 60;\n                return transformTime(hour) + \":\" + transformTime(minute)\n                    + \":\" + transformTime(second);\n            }\n\n            //转换时间\n            function transformTime(time) {\n                if (time < 10) {\n                    return \"0\" + time;\n                } else {\n                    return time;\n                }\n            }\n        }\n    }\n\n    var players = document.getElementsByClassName(\"audioPlayer\");\n    addPlayerEvents(players);\n})();\n\n\n(function () {\n    var pageList = document.getElementsByClassName(\"section-pageList\")[0],\n        navBar = document.getElementsByClassName(\"section-nav-bar\")[0],\n        navList = document.getElementById(\"nav-list\"),\n        navEdit = document.getElementById(\"nav-edit\"),\n        navUp = document.getElementById(\"nav-up\"),\n        editArea = document.getElementById(\"edit-area\"),\n        ansBtns = document.getElementsByClassName(\"section-ans-btn\");\n\n\n    //对ans按钮添加点击事件的监听\n    for (var i = 0, len = ansBtns.length; i < len; i++) {\n        ansBtns[i].onclick = function () {\n            if (this.className === \"section-ans-btn\" + \" \" + \"section-ans-btn-show\") {\n                this.className = \"section-ans-btn\" + \" \" + \"section-ans-btn-hidden\";\n                this.nextElementSibling.className = \"section-ans-table\" + \" \" +\n                    \"section-ans-table-hidden\";\n            } else {\n                this.className = \"section-ans-btn\" + \" \" + \"section-ans-btn-show\";\n                this.nextElementSibling.className = \"section-ans-table\" + \" \" +\n                    \"section-ans-table-show\";\n            }\n        }\n    }\n\n\n    //对list按钮添加点击事件的监听\n    navList.onclick = function (event) {\n        if (navBar.className === \"section-nav-bar\" + \" \" + \"section-nav-bar-hidden\") {\n            navBar.className = \"section-nav-bar\" + \" \" + \"section-nav-bar-show\";\n            pageList.className = \"section-pageList\" + \" \" + \"section-pageList-show\";\n            event.stopPropagation();\n        }\n    };\n\n\n    //对edit按钮添加点击事件的监听\n    navEdit.onclick = function (event) {\n        editArea.className = \"edit-area-show\";\n        event.stopPropagation();\n    };\n\n\n    //对发生在editArea中的点击事件进行处理\n    editArea.onclick = function (event) {\n        event.stopPropagation();\n    };\n\n    //对点击事件进行处理\n    window.addEventListener(\"click\", function () {\n        if (navBar.className === \"section-nav-bar\" + \" \" + \"section-nav-bar-show\") {\n            navBar.className = \"section-nav-bar\" + \" \" + \"section-nav-bar-hidden\";\n            pageList.className = \"section-pageList\" + \" \" + \"section-pageList-hidden\";\n        }\n        editArea.className = \"edit-area-hidden\";\n    });\n\n    navUp.onclick = function () {\n        document.body.scrollTop = 0;\n    };\n})();\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- js/sections.js	(date 1496567486000)
+++ js/sections.js	(revision )
@@ -1,21 +1,20 @@
 /**
  * Created by zackbee on 17-6-4.
  */
-(function () {
-    /* addPlayerEvents
-     * Version 1.0
-     * created by ZackBee
-     * 2017.06.03*/
+/* addPlayerEvents
+ * Version 1.0
+ * created by ZackBee
+ * 2017.06.03*/
 
-    /* 此代码支持IE9+以及其他浏览器，
-     * 使用了dom2级的特性，由于IE8
-     * 以及以下版本（未完全支持dom2）
-     * 未实现audio,video所以不用考虑*/
-
+/* 此代码支持IE9+以及其他浏览器，
+ * 使用了dom2级的特性，由于IE8
+ * 以及以下版本（未完全支持dom2）
+ * 未实现audio,video所以不用考虑*/
+window.onload = function () {
     function addPlayerEvents(element) {
         "use strict";
         //传入单个元素
-        if (element.length === 1) {
+        if (element.nodeType === 1) {
             addEvents(element);
         } else {
             //传入nodeList
@@ -160,9 +159,9 @@
         }
     }
 
-    var players = document.getElementsByClassName("audioPlayer");
+    var players = document.getElementById("audioPlayer");
     addPlayerEvents(players);
-})();
+};
 
 
 (function () {
